<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DO-AN-02: About project</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DO-AN-02<span id="projectnumber">&#160;0.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('index.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">About project </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_readme"></a></p>
<p>This is one of three projects (Project 01, Project 02, and the Graduation Project - Capstone Project). In this project, I will develop a device that analyzes data on SPI/I2C buses and captures analog signals for display like an oscilloscope.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md1"></a>
About team</h1>
<p>My team consists of two members:</p><ul>
<li>Nguyen Thanh Phu – Student ID: 22119211 – Contact: <a href="#" onclick="location.href='mai'+'lto:'+'nth'+'an'+'hph'+'u.'+'k22'+'.h'+'cmu'+'te'+'@gm'+'ai'+'l.c'+'om'; return false;">nthan<span class="obfuscator">.nosp@m.</span>hphu<span class="obfuscator">.nosp@m.</span>.k22.<span class="obfuscator">.nosp@m.</span>hcmu<span class="obfuscator">.nosp@m.</span>te@gm<span class="obfuscator">.nosp@m.</span>ail.<span class="obfuscator">.nosp@m.</span>com</a> (myself)</li>
<li>Nguyen Van Quoc – Student ID: 22119222 – Contact: <a href="#" onclick="location.href='mai'+'lto:'+'quo'+'cv'+'an5'+'61'+'@gm'+'ai'+'l.c'+'om'; return false;">quocv<span class="obfuscator">.nosp@m.</span>an56<span class="obfuscator">.nosp@m.</span>1@gma<span class="obfuscator">.nosp@m.</span>il.c<span class="obfuscator">.nosp@m.</span>om</a></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md2"></a>
About device</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md3"></a>
General system architecture</h2>
<p>The image below describe the blocks diagram of the device.</p>
<p><img src="imgs/SysArchBlockDiagram.png" alt="" style="width:500px" class="inline"/></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md4"></a>
Project strurture</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md5"></a>
Working-tree</h2>
<h3 class="doxsection"><a class="anchor" id="autotoc_md6"></a>
Top-level</h3>
<div class="fragment"><div class="line">. Current reposistory / Root directory (rootDir)</div>
<div class="line">|</div>
<div class="line">├── CMakeLists.txt              [01] Main CMake build configuration file</div>
<div class="line">├── comDriver                   [02] Communication drivers (SPI, I2C, LCD, etc.)</div>
<div class="line">├── config                      [03] System and hardware configuration files</div>
<div class="line">├── diagram                     [04] System and hardware diagrams (.drawio)</div>
<div class="line">├── fonts                       [05] Font data used for LCD display</div>
<div class="line">├── helper                      [06] Utility/helper functions and tools</div>
<div class="line">├── main                        [07] Main application source (app_main entry point)</div>
<div class="line">├── readme.md                   [08] Project description and build instructions</div>
<div class="line">├── sdkconfig                   [09] ESP-IDF build configuration (auto-generated)</div>
<div class="line">└── sdkconfig.old               [10] Backup of previous sdkconfig</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md7"></a>
2nd-level | [06] helper</h3>
<p>This directory provides a collection of helper modules and utility functions that support system-wide consistency and simplify hardware communication components.</p>
<p>All common dependencies — including FreeRTOS headers, GPIO definitions, and shared utility functions — are centralized here. By consolidating these shared resources, the project ensures:</p>
<ul>
<li>A consistent and standardized include order across all components.</li>
<li>Proper initialization sequencing, managed automatically through <span class="tt">helper/general.h</span>.</li>
</ul>
<p>Simplified maintenance — other libraries only need to include <span class="tt">helper/general.h</span>, without worrying about dependency order or redundant includes.</p>
<div class="fragment"><div class="line">helper/</div>
<div class="line">├── CMakeLists.txt                  [06.01] </div>
<div class="line">├── espGPIOWrapper.h                [06.02]</div>
<div class="line">├── espLogWrapper.h                 [06.03]</div>
<div class="line">├── espRTOSWrapper.h                [06.04]</div>
<div class="line">├── flag.h                          [06.05]</div>
<div class="line">├── general.h                       [06.06]</div>
<div class="line">├── helper.c                        [06.07]</div>
<div class="line">├── helper.h                        [06.08]</div>
<div class="line">├── param.h                         [06.09]</div>
<div class="line">└── return.h                        [06.10]</div>
</div><!-- fragment --><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">ID  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">[06.01]  </td><td class="markdownTableBodyLeft">Build configuration file for the helper module using CMake  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">[06.02]  </td><td class="markdownTableBodyLeft">Wrapper header for ESP32 GPIO functions to abstract hardware-specific implementations  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">[06.03]  </td><td class="markdownTableBodyLeft">Wrapper header for ESP32 logging functions to standardize logging across the project  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">[06.04]  </td><td class="markdownTableBodyLeft">Wrapper header for ESP32 RTOS functions to abstract RTOS-specific implementations  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">[06.05]  </td><td class="markdownTableBodyLeft">Contains flag definitions and enums used throughout the project  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">[06.06]  </td><td class="markdownTableBodyLeft">General purpose utility functions and macros  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">[06.07]  </td><td class="markdownTableBodyLeft">Implementation of helper functions defined in helper.h  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">[06.08]  </td><td class="markdownTableBodyLeft">Main header file declaring common helper functions used across the project  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">[06.09]  </td><td class="markdownTableBodyLeft">Defines parameters and constants used in the project  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">[06.10]  </td><td class="markdownTableBodyLeft">Contains return codes and error definitions  </td></tr>
</table>
<p>In short, [06] helper/ acts as the foundation layer that unifies all components and guarantees reliable, modular system integration.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md8"></a>
2nd-level | [02] comDriver</h3>
<p>This directory contains hardware communication modules (components). To maintain a consistent and standardized header inclusion order, all common headers (FreeRTOS, GPIO, helper utilities) are defined under [06] helper. These shared headers are then included by other libraries through helper/general.h, which guarantees proper initialization order — so regardless of how or where a function is called later within components, the inclusion sequence remains correct and reliable.</p>
<div class="fragment"><div class="line">.</div>
<div class="line">├── i2c                         [02.01]</div>
<div class="line">│   ├── CMakeLists.txt                  [02.01.01]</div>
<div class="line">│   ├── i2c.c                           [02.01.02]</div>
<div class="line">│   ├── i2c.h                           [02.01.03]</div>
<div class="line">│   ├── i2cDefinition.h                 [02.01.04]</div>
<div class="line">│   ├── i2cHelper.h                     [02.01.05]</div>
<div class="line">│   └── i2cLog.h                        [02.01.06]</div>
<div class="line">├── lcd32                       [02.02]</div>
<div class="line">│   ├── CMakeLists.txt</div>
<div class="line">│   ├── lcd32.c</div>
<div class="line">│   ├── lcd32.h</div>
<div class="line">│   ├── lcd32Cmd.h</div>
<div class="line">│   ├── lcd32Def.h</div>
<div class="line">│   └── lcd32Helper.h</div>
<div class="line">├── oled128x64                  [02.03]</div>
<div class="line">│   ├── CMakeLists.txt</div>
<div class="line">│   ├── oled128x64.c</div>
<div class="line">│   ├── oled128x64.h</div>
<div class="line">│   ├── oled128x64Commands.h</div>
<div class="line">│   ├── oled128x64Definitions.h</div>
<div class="line">│   ├── oled128x64Helpers.h</div>
<div class="line">│   └── oled128x64Log.h</div>
<div class="line">└── spi                         [02.04]</div>
<div class="line">    ├── CMakeLists.txt</div>
<div class="line">    ├── spi.c</div>
<div class="line">    └── spi.h</div>
</div><!-- fragment --><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">ID  </th><th class="markdownTableHeadLeft">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">[02.01]  </td><td class="markdownTableBodyLeft">I2C communication driver directory containing all I2C-related implementations  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">[02.01.01]  </td><td class="markdownTableBodyLeft">CMake build configuration file for I2C module  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">[02.01.02]  </td><td class="markdownTableBodyLeft">Main I2C driver implementation source file  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">[02.01.03]  </td><td class="markdownTableBodyLeft">Main I2C driver header file with public interfaces  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">[02.01.04]  </td><td class="markdownTableBodyLeft">I2C protocol definitions and constants  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">[02.01.05]  </td><td class="markdownTableBodyLeft">Helper functions and utilities specific to I2C operations  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">[02.01.06]  </td><td class="markdownTableBodyLeft">Logging functionality specific to I2C module  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">[02.02]  </td><td class="markdownTableBodyLeft">LCD32 driver directory for 3.2" ILI9341 LCD display  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">[02.03]  </td><td class="markdownTableBodyLeft">OLED128x64 driver directory for 128x64 OLED display  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">[02.04]  </td><td class="markdownTableBodyLeft">SPI communication driver directory containing SPI protocol implementations  </td></tr>
</table>
<p>To add new components, you should follow the existing directory structure — or at least make sure each component contains a header file (header.h) and a CMakeLists.txt file. Below is the standard structure of a CMakeLists.txt file inside each component.</p>
<p>Afterward, to make your new components functional, you need to ensure two things:</p><ol type="1">
<li>Ensure that all required dependencies are listed under the REQUIRES field in your component’s CMakeLists.txt.</li>
<li>You have added the component’s path in the main CMakeLists.txt [1] (see the example code below on how to register additional components in the main build system) so that ESP-IDF can detect and include it during the build process.</li>
</ol>
<div class="fragment"><div class="line">.txt</div>
<div class="line">   # Tell CMake to look for additional components in the &#39;comDriver&#39;,  directory</div>
<div class="line">   set(EXTRA_COMPONENT_DIRS</div>
<div class="line">       &quot;fonts&quot;</div>
<div class="line">       &quot;helper&quot;</div>
<div class="line">       &quot;comDriver/lcd32&quot;</div>
<div class="line">   )</div>
</div><!-- fragment --><p>The CMakeLists.txt for each component look like:</p>
<div class="fragment"><div class="line">.txt</div>
<div class="line">   idf_component_register(</div>
<div class="line">       SRCS &quot;lcd32.c&quot;</div>
<div class="line">       INCLUDE_DIRS &quot;.&quot;</div>
<div class="line">       REQUIRES esp_driver_gpio esp_driver_spi esp_timer</div>
<div class="line">   )</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md9"></a>
2nd-level | [07] main</h3>
<p>This directory represents the entry point of the application. It contains the main source file that initializes and runs the core system logic. The diagram below illustrates its internal structure.</p>
<div class="fragment"><div class="line">.</div>
<div class="line">├── CMakeLists.txt              [07.01] — CMake build configuration for the main application</div>
<div class="line">├── monitor.h                   [07.02] — Main header file for system monitoring or debugging utilities</div>
<div class="line">└── myApp.c                     [07.03] — Main application source file containing app_main() and core logic</div>
</div><!-- fragment --><p>To use user-defined components, you need to add the <span class="tt">target_include_directories</span> command to the CMakeLists.txt [07.01]. The example below demonstrates a typical configuration:</p>
<div class="fragment"><div class="line">idf_component_register(SRCS &quot;myApp.c&quot;</div>
<div class="line">                    INCLUDE_DIRS &quot;.&quot;)</div>
<div class="line"> </div>
<div class="line">target_include_directories(${COMPONENT_TARGET}</div>
<div class="line">    PUBLIC</div>
<div class="line">        ../config</div>
<div class="line">        ../helper</div>
<div class="line">)</div>
</div><!-- fragment --><p><b>Fun note</b>: Normally, all global variables declared in a header file should be marked as static or extern. However, since the header file in this directory is included only once (by myApp.c), you may declare regular global variables directly for simplicity and readability.</p>
<p>The diagram below describe flow to add new component.</p>
<p><img src="imgs/DevGuideAddComponents.png" alt="" style="width:700px" class="inline"/></p>
<p><b>Identify error due to forget to add REQUIRES in CMaskLists.txt</b>:</p>
<div class="fragment"><div class="line">In file included from /home/fus/Documents/DO-AN-02-LCD/helper/general.h:32,</div>
<div class="line">                 from /home/fus/Documents/DO-AN-02-LCD/helper/helper.c:1:</div>
<div class="line">/home/fus/Documents/DO-AN-02-LCD/helper/espGPIOWrapper.h:9:10: fatal error: driver/gpio.h: No such file or directory</div>
<div class="line">    9 | #include &quot;driver/gpio.h&quot;        /// high-level GPIO driver (gpio_set_level, gpio_get_level, gpio_config)</div>
<div class="line">      |          ^~~~~~~~~~~~~~~</div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">make: *** [Makefile:136: all] Error 2</div>
<div class="line">Compilation failed because espGPIOWrapper.h (in &quot;helper&quot; component) includes driver/gpio.h, provided by esp_driver_gpio component(s).</div>
<div class="line">However, esp_driver_gpio component(s) is not in the requirements list of &quot;helper&quot;.</div>
<div class="line">To fix this, add esp_driver_gpio to REQUIRES list of idf_component_register call in /home/fus/Documents/DO-AN-02-LCD/helper/CMakeLists.txt.</div>
<div class="line">make failed with exit code 2, output of the command is in the /home/fus/Documents/DO-AN-02-LCD/build/log/idf_py_stderr_output_5978 and /home/fus/Documents/DO-AN-02-LCD/build/log/idf_py_stdout_output_5978</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md10"></a>
Full working-tree</h3>
<div class="fragment"><div class="line">├── CMakeLists.txt</div>
<div class="line">├── comDriver</div>
<div class="line">│   ├── i2c</div>
<div class="line">│   │   ├── CMakeLists.txt</div>
<div class="line">│   │   ├── i2c.c</div>
<div class="line">│   │   ├── i2c.h</div>
<div class="line">│   │   ├── i2cDefinition.h</div>
<div class="line">│   │   ├── i2cHelper.h</div>
<div class="line">│   │   └── i2cLog.h</div>
<div class="line">│   ├── lcd32</div>
<div class="line">│   │   ├── CMakeLists.txt</div>
<div class="line">│   │   ├── lcd32.c</div>
<div class="line">│   │   ├── lcd32.h</div>
<div class="line">│   │   ├── lcd32Cmd.h</div>
<div class="line">│   │   ├── lcd32Def.h</div>
<div class="line">│   │   └── lcd32Helper.h</div>
<div class="line">│   ├── oled128x64</div>
<div class="line">│   │   ├── CMakeLists.txt</div>
<div class="line">│   │   ├── oled128x64.c</div>
<div class="line">│   │   ├── oled128x64.h</div>
<div class="line">│   │   ├── oled128x64Commands.h</div>
<div class="line">│   │   ├── oled128x64Definitions.h</div>
<div class="line">│   │   ├── oled128x64Helpers.h</div>
<div class="line">│   │   └── oled128x64Log.h</div>
<div class="line">│   └── spi</div>
<div class="line">│       ├── CMakeLists.txt</div>
<div class="line">│       ├── spi.c</div>
<div class="line">│       └── spi.h</div>
<div class="line">├── config</div>
<div class="line">│   ├── CMakeLists.txt</div>
<div class="line">│   ├── projectConfig.h</div>
<div class="line">│   └── pinConfig.h                         (Deprecated)</div>
<div class="line">├── diagram</div>
<div class="line">│   ├── diagram01.drawio</div>
<div class="line">│   └── diagram02.drawio</div>
<div class="line">├── fonts</div>
<div class="line">│   ├── CMakeLists.txt</div>
<div class="line">│   ├── fontUtils.c</div>
<div class="line">│   ├── fontUtils.h</div>
<div class="line">│   └── gfxfont.h</div>
<div class="line">├── helper</div>
<div class="line">│   ├── CMakeLists.txt</div>
<div class="line">│   ├── espGPIOWrapper.h</div>
<div class="line">│   ├── espLogWrapper.h</div>
<div class="line">│   ├── espRTOSWrapper.h</div>
<div class="line">│   ├── flag.h</div>
<div class="line">│   ├── general.h</div>
<div class="line">│   ├── helper.c</div>
<div class="line">│   ├── helper.h</div>
<div class="line">│   ├── param.h</div>
<div class="line">│   └── return.h</div>
<div class="line">├── main</div>
<div class="line">│   ├── CMakeLists.txt</div>
<div class="line">│   ├── monitor.h</div>
<div class="line">│   └── myApp.c</div>
<div class="line">├── readme.md</div>
<div class="line">├── sdkconfig</div>
<div class="line">└── sdkconfig.old</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md11"></a>
Useful links</h1>
<ul>
<li><a href="https://www.lazada.vn/products/diymore-esp32-s3-n16r8-bang-mach-phat-trien-lap-trinh-hoi-dong-quan-tri-xiaozhi-ai-giong-noi-thong-minh-may-voi-091-inch-oled-bo-ket-hop-i3051811347.html">ESP32-S3 N16R8 DevKitC Module</a></li>
<li><a href="https://www.waveshare.com/wiki/3.2inch_320x240_Touch_LCD_(D)">3.2inch 320x240 Touch LCD (D)</a> </li>
</ul>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
